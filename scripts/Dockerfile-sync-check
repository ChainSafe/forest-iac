FROM fedora:36

LABEL org.opencontainers.image.source https://github.com/chainsafe/forest-iac

RUN dnf -y install \
    docker \
    docker-compose \
    ruby \
    ruby-devel \
    make \
    gcc \
    && dnf clean all

WORKDIR /chainsafe

COPY Gemfile Gemfile.lock ./

RUN gem install bundler:2.3.4 && bundle install

COPY ruby_common ruby_common
COPY sync_check/* ./

ENTRYPOINT ["/bin/bash", "run_service.sh"]
